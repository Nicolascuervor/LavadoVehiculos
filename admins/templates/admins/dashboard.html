{% extends 'base.html' %}
{% load static %} {# Asegúrate de cargar static si usas archivos CSS/JS externos en base.html #}

{% block title %}Panel de Administración | Auto Spa Lavadero{% endblock %}

{% block content %}
<div class="flex h-screen bg-gray-100">

    <aside class="hidden md:flex md:flex-shrink-0">
        <div class="flex flex-col w-64">
            <div class="flex items-center justify-center h-16 bg-blue-700 text-white shadow-md">
                {# Puedes poner un logo más pequeño aquí si quieres #}
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                </svg>
                <span class="text-xl font-semibold">Auto Spa Admin</span>
            </div>
            <nav class="flex-1 px-2 py-4 space-y-1 bg-white border-r border-gray-200">
                <a href="{% url 'admins:dashboard' %}" class="flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md group">
                    <svg class="mr-3 h-6 w-6 text-blue-300" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                    Dashboard
                </a>
                <a href="{% url 'admins:user_list' %}" class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900 group">
                    <svg class="mr-3 h-6 w-6 text-gray-400 group-hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                    Usuarios
                </a>
                 <a href="{% url 'admins:employee_request_list' %}" class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900 group">
                    <svg class="mr-3 h-6 w-6 text-gray-400 group-hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                    </svg>
                    Solicitudes Empleo
                    {% if numero_solicitudes_pendientes > 0 %}
                    <span class="ml-auto inline-block py-0.5 px-3 text-xs font-medium text-white bg-red-500 rounded-full">{{ numero_solicitudes_pendientes }}</span>
                    {% endif %}
                </a>
                <a href="{% url 'admins:cliente_list' %}" class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900 group">
                   <svg class="mr-3 h-6 w-6 text-gray-400 group-hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                   </svg>
                    Clientes
                </a>
                <a href="{% url 'admins:vehicle_list' %}" class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900 group">
                    <svg class="mr-3 h-6 w-6 text-gray-400 group-hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
                    </svg>
                    Vehículos
                </a>
                 <a href="{% url 'admins:service_list' %}" class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900 group">
                   <svg class="mr-3 h-6 w-6 text-gray-400 group-hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                   </svg>
                    Servicios
                </a>
                <a href="{% url 'admins:reports_dashboard' %}" class="flex items-center px-4 py-2 text-sm font-medium text-gray-700 rounded-md hover:bg-gray-100 hover:text-gray-900 group">
                    <svg class="mr-3 h-6 w-6 text-gray-400 group-hover:text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                     Informes
                 </a>
                {# Otros enlaces como Configuración, etc. #}
            </nav>
        </div>
    </aside>

    <div class="flex flex-col flex-1 w-0 overflow-hidden">
        <header class="relative bg-white shadow-sm z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <button class="md:hidden p-1 text-gray-500 rounded-md hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500" id="mobile-menu-button">
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>

                    <div class="flex-1 flex justify-center px-2 lg:ml-6 lg:justify-end">
                        <div class="max-w-lg w-full lg:max-w-xs">
                            <label for="search" class="sr-only">Buscar</label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <input id="search" name="search" class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm" placeholder="Buscar cliente, placa..." type="search">
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center space-x-4">
                        <button class="p-1 text-gray-400 rounded-full hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" id="notification-button">
                             <span class="sr-only">Ver notificaciones</span>
                             <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341A6.002 6.002 0 006 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                             </svg>
                             {% if notificaciones_no_leidas_count > 0 %}
                             <span class="absolute top-0 right-0 block h-2.5 w-2.5 rounded-full ring-2 ring-white bg-red-400"></span>
                             {% endif %}
                        </button>
                        <div id="notification-dropdown" class="hidden origin-top-right absolute right-0 mt-2 w-80 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none" role="menu" aria-orientation="vertical" aria-labelledby="notification-button">
                            {# Contenido del dropdown de notificaciones aquí #}
                            <p class="p-4 text-sm text-gray-500">No hay notificaciones nuevas.</p>
                        </div>

                        <div class="relative">
                            <button type="button" class="max-w-xs bg-white rounded-full flex items-center text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" id="user-dropdown-button" aria-expanded="false" aria-haspopup="true">
                                <span class="sr-only">Abrir menú de usuario</span>
                                <img class="h-8 w-8 rounded-full" src="{% static 'images/default-avatar.png' %}" alt="Avatar de {{ user.username }}"> {# Placeholder image #}
                                <span class="hidden md:block ml-2 text-sm font-medium text-gray-700">{{ user.username }}</span>
                                <svg class="hidden md:block ml-1 h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                  <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                            </button>
                             <div id="user-dropdown" class="hidden origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none" role="menu" aria-orientation="vertical" aria-labelledby="user-dropdown-button">
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">Mi Perfil</a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">Configuración</a>
                                <a href="{% url 'logout' %}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" role="menuitem">Cerrar Sesión</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="hidden md:hidden" id="mobile-menu">
                 <nav class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                     {# Replicar enlaces del sidebar aquí para móvil #}
                 </nav>
            </div>
        </header>

        <main class="flex-1 relative overflow-y-auto focus:outline-none p-6">
            <h1 class="text-2xl font-semibold text-gray-900 mb-6">Dashboard</h1>

            <div class="mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-medium text-gray-800">Resumen General</h2>
                    <div class="flex space-x-2">
                        {# Placeholder para filtros de fecha - requiere JS #}
                        <button class="px-3 py-1 text-xs font-medium text-gray-600 bg-gray-200 rounded hover:bg-gray-300">Hoy</button>
                        <button class="px-3 py-1 text-xs font-medium text-gray-600 bg-white border rounded hover:bg-gray-50">Semana</button>
                        <button class="px-3 py-1 text-xs font-medium text-gray-600 bg-white border rounded hover:bg-gray-50">Mes</button>
                    </div>
                </div>
                <div class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 fade-in-section">
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-blue-500 rounded-md p-3">
                                     <svg class="h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                     </svg>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Total Clientes</dt>
                                        <dd class="flex items-baseline">
                                            <div class="text-2xl font-semibold text-gray-900 counter" data-target="{{ total_clientes | default:0 }}">{{ total_clientes | default:0 }}</div>
                                            {# <span class="ml-2 text-sm font-medium text-green-600">+5 Nuevos</span> #}
                                        </dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                        {# <div class="bg-gray-50 px-5 py-3">
                            <div class="text-sm">
                                <a href="{% url 'admins:cliente_list' %}" class="font-medium text-blue-700 hover:text-blue-900"> Ver todos </a>
                            </div>
                        </div> #}
                        {# Placeholder para mini-gráfico #}
                        <div class="h-16 bg-gray-50 p-2 chart-placeholder" data-chart-type="client-growth"></div>
                    </div>

                    <div class="bg-white overflow-hidden shadow rounded-lg">
                         <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-green-500 rounded-md p-3">
                                    <svg class="h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                                    </svg>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Servicios Hoy</dt>
                                        <dd>
                                            <div class="text-2xl font-semibold text-gray-900 counter" data-target="{{ servicios_hoy | default:0 }}">{{ servicios_hoy | default:0 }}</div>
                                        </dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                         {# Placeholder para mini-gráfico (e.g., por hora) #}
                        <div class="h-16 bg-gray-50 p-2 chart-placeholder" data-chart-type="services-today"></div>
                    </div>

                    <div class="bg-white overflow-hidden shadow rounded-lg">
                         <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-yellow-500 rounded-md p-3">
                                     <svg class="h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                     </svg>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Ingresos Hoy (COP)</dt> {# Asumiendo COP #}
                                        <dd>
                                             {# Usar templatetag 'intcomma' para formatear miles si está cargado #}
                                            <div class="text-2xl font-semibold text-gray-900 counter-currency" data-target="{{ ingresos_hoy | default:0 }}">${{ ingresos_hoy | floatformat:0 | default:0 }}</div>
                                        </dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                         {# Placeholder para mini-gráfico (tendencia ingresos) #}
                        <div class="h-16 bg-gray-50 p-2 chart-placeholder" data-chart-type="income-trend"></div>
                    </div>

                    <div class="bg-white overflow-hidden shadow rounded-lg">
                         <div class="p-5">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-purple-500 rounded-md p-3">
                                    <svg class="h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                         <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                                     </svg>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dl>
                                        <dt class="text-sm font-medium text-gray-500 truncate">Empleados Activos</dt>
                                        <dd>
                                            <div class="text-2xl font-semibold text-gray-900 counter" data-target="{{ total_empleados | default:0 }}">{{ total_empleados | default:0 }}</div>
                                        </dd>
                                    </dl>
                                </div>
                            </div>
                        </div>
                         {# Placeholder para ¿mini-gráfico? (quizás no aplica tanto aquí) #}
                         <div class="h-16 bg-gray-50 p-2"></div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <div class="lg:col-span-1 bg-white shadow rounded-lg p-6 card-reveal">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Acciones Rápidas</h3>
                    <ul class="space-y-3">
                        {% for accion in acciones_rapidas_list %} {# Placeholder: Iterar sobre lista de acciones #}
                        <li class="flex items-center justify-between">
                            <span class="text-sm text-gray-700">{{ accion.descripcion }}</span>
                            <a href="{{ accion.url }}" class="px-3 py-1 text-xs font-medium text-white bg-blue-600 rounded hover:bg-blue-700">
                                {{ accion.texto_boton }}
                            </a>
                        </li>
                        {% empty %}
                         <li>
                            <span class="text-sm text-gray-500">No hay acciones pendientes.</span>
                         </li>
                         {% endfor %}
                        {# Ejemplo estático si no hay lista: #}
                         {% if not acciones_rapidas_list %}
                         <li class="flex items-center justify-between">
                             <div>
                                <p class="text-sm text-gray-700">Solicitudes Pendientes</p>
                                <p class="text-xs text-gray-500">{{ numero_solicitudes_pendientes | default:0 }} esperando aprobación</p>
                             </div>
                             <a href="{% url 'admins:employee_request_list' %}" class="px-3 py-1 text-xs font-medium text-white bg-blue-600 rounded hover:bg-blue-700">Revisar</a>
                         </li>
                          <li class="flex items-center justify-between">
                             <span class="text-sm text-gray-700">Registrar Nuevo Lavado</span>
                             <a href="#" class="px-3 py-1 text-xs font-medium text-white bg-green-600 rounded hover:bg-green-700">Agregar</a>
                         </li>
                         {% endif %}

                    </ul>
                </div>

                <div class="lg:col-span-2 bg-white shadow rounded-lg p-6 card-reveal" style="animation-delay: 0.1s;">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Actividad Reciente</h3>
                     <ul class="divide-y divide-gray-200">
                        {% for actividad in actividad_reciente_list|slice:":5" %} {# Placeholder: Iterar y limitar a 5 #}
                        <li class="py-3 flex items-center space-x-3">
                            <div class="flex-shrink-0">
                                {# Icono según tipo de actividad #}
                                <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="text-sm text-gray-800">{{ actividad.descripcion }}</p>
                                <p class="text-xs text-gray-500">{{ actividad.timestamp|timesince }} atrás</p> {# Formato de tiempo relativo #}
                            </div>
                        </li>
                        {% empty %}
                        <li>
                            <p class="text-sm text-gray-500 py-3">No hay actividad reciente.</p>
                        </li>
                        {% endfor %}
                         {# Ejemplo estático: #}
                         {% if not actividad_reciente_list %}
                           <li class="py-3 flex items-center space-x-3">
                               <div class="flex-shrink-0"><svg class="h-5 w-5 text-green-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg></div>
                               <div class="flex-1"><p class="text-sm text-gray-800">Servicio 'Lavado Premium' completado para <span class="font-medium">ABC-123</span>.</p><p class="text-xs text-gray-500">hace 5 minutos</p></div>
                           </li>
                            <li class="py-3 flex items-center space-x-3">
                               <div class="flex-shrink-0"><svg class="h-5 w-5 text-blue-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M8 9a3 3 0 100-6 3 3 0 000 6zM8 11a6 6 0 016 6H2a6 6 0 016-6zM16 7a1 1 0 10-2 0v1h-1a1 1 0 100 2h1v1a1 1 0 102 0v-1h1a1 1 0 100-2h-1V7z" /></svg></div>
                               <div class="flex-1"><p class="text-sm text-gray-800">Nuevo cliente <span class="font-medium">Ana García</span> registrado.</p><p class="text-xs text-gray-500">hace 1 hora</p></div>
                           </li>
                         {% endif %}
                    </ul>
                    {# Placeholder para botón "Ver toda la actividad" #}
                </div>
            </div>


            <h2 class="text-lg font-medium text-gray-800 mb-4">Gestión del Sistema</h2>
            <div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
                {# Card: Usuarios #}
                <div class="bg-white rounded-lg shadow overflow-hidden transform transition-transform duration-300 hover:-translate-y-1 hover:shadow-lg card-reveal" style="animation-delay: 0.2s;">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                           <div class="p-3 rounded-full bg-blue-100 text-blue-600 mr-4">
                               <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" /></svg>
                           </div>
                           <h3 class="text-lg font-semibold text-gray-800">Usuarios</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Gestiona accesos y permisos.</p>
                        <div class="flex justify-between items-center">
                             <a href="{% url 'admins:user_list' %}" class="inline-flex items-center px-3 py-1.5 text-sm font-medium bg-blue-500 text-white rounded-md hover:bg-blue-600">
                                <span>Gestionar</span>
                                <svg class="ml-2 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                             </a>
                            <span class="text-xs text-gray-500">{{ total_usuarios | default:0 }} en total</span>
                        </div>
                    </div>
                </div>

                 {# Card: Solicitudes Empleados #}
                <div class="bg-white rounded-lg shadow overflow-hidden transform transition-transform duration-300 hover:-translate-y-1 hover:shadow-lg card-reveal" style="animation-delay: 0.3s;">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                           <div class="p-3 rounded-full bg-green-100 text-green-600 mr-4">
                               <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" /></svg>
                           </div>
                           <h3 class="text-lg font-semibold text-gray-800">Solicitudes Empleo</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Revisa y aprueba nuevas solicitudes.</p>
                        <div class="flex justify-between items-center">
                             <a href="{% url 'admins:employee_request_list' %}" class="inline-flex items-center px-3 py-1.5 text-sm font-medium bg-green-500 text-white rounded-md hover:bg-green-600">
                                <span>Gestionar</span>
                                <svg class="ml-2 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                             </a>
                             {% if numero_solicitudes_pendientes > 0 %}
                             <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">{{ numero_solicitudes_pendientes }} Nuevas</span>
                             {% else %}
                             <span class="text-xs text-gray-500">Ninguna pendiente</span>
                             {% endif %}
                        </div>
                    </div>
                </div>

                 {# Card: Clientes #}
                 <div class="bg-white rounded-lg shadow overflow-hidden transform transition-transform duration-300 hover:-translate-y-1 hover:shadow-lg card-reveal" style="animation-delay: 0.4s;">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                           <div class="p-3 rounded-full bg-orange-100 text-orange-600 mr-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                           </div>
                           <h3 class="text-lg font-semibold text-gray-800">Clientes</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Gestiona la base de datos de clientes.</p>
                        <div class="flex justify-between items-center">
                             <a href="{% url 'admins:cliente_list' %}" class="inline-flex items-center px-3 py-1.5 text-sm font-medium bg-orange-500 text-white rounded-md hover:bg-orange-600">
                                <span>Gestionar</span>
                                <svg class="ml-2 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                             </a>
                            <span class="text-xs text-gray-500">{{ total_clientes_registrados | default:0 }} en total</span>
                        </div>
                    </div>
                </div>

                 {# Card: Servicios #}
                 <div class="bg-white rounded-lg shadow overflow-hidden transform transition-transform duration-300 hover:-translate-y-1 hover:shadow-lg card-reveal" style="animation-delay: 0.5s;">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                           <div class="p-3 rounded-full bg-purple-100 text-purple-600 mr-4">
                               <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" /></svg>
                           </div>
                           <h3 class="text-lg font-semibold text-gray-800">Servicios</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Administra los tipos de servicios ofrecidos.</p>
                        <div class="flex justify-between items-center">
                             <a href="{% url 'admins:service_list' %}" class="inline-flex items-center px-3 py-1.5 text-sm font-medium bg-purple-500 text-white rounded-md hover:bg-purple-600">
                                <span>Gestionar</span>
                                <svg class="ml-2 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                             </a>
                            <span class="text-xs text-gray-500">{{ numero_tipos_servicio | default:0 }} tipos</span>
                        </div>
                    </div>
                </div>

                 {# Card: Vehículos #}
                 <div class="bg-white rounded-lg shadow overflow-hidden transform transition-transform duration-300 hover:-translate-y-1 hover:shadow-lg card-reveal" style="animation-delay: 0.6s;">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                           <div class="p-3 rounded-full bg-gray-200 text-gray-600 mr-4">
                              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" /></svg>
                           </div>
                           <h3 class="text-lg font-semibold text-gray-800">Vehículos</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Gestiona los vehículos registrados.</p>
                        <div class="flex justify-between items-center">
                             <a href="{% url 'admins:vehicle_list' %}" class="inline-flex items-center px-3 py-1.5 text-sm font-medium bg-gray-700 text-white rounded-md hover:bg-gray-800">
                                <span>Gestionar</span>
                                <svg class="ml-2 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                             </a>
                            <span class="text-xs text-gray-500">{{ total_vehiculos_registrados | default:0 }} en total</span>
                        </div>
                    </div>
                </div>

                 {# Card: Informes #}
                 <div class="bg-white rounded-lg shadow overflow-hidden transform transition-transform duration-300 hover:-translate-y-1 hover:shadow-lg card-reveal" style="animation-delay: 0.7s;">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                           <div class="p-3 rounded-full bg-cyan-100 text-cyan-600 mr-4">
                               <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>
                           </div>
                           <h3 class="text-lg font-semibold text-gray-800">Informes</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Accede a informes detallados.</p>
                        <div class="flex justify-between items-center">
                             <a href="{% url 'admins:reports_dashboard' %}" class="inline-flex items-center px-3 py-1.5 text-sm font-medium bg-cyan-500 text-white rounded-md hover:bg-cyan-600">
                                <span>Ver Informes</span>
                                <svg class="ml-2 h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
                             </a>
                            {# Puedes añadir un badge con la fecha del último informe generado #}
                            {# <span class="text-xs text-gray-500">Actualizado Ayer</span> #}
                        </div>
                    </div>
                </div>

            </div> {# Fin grid gestión sistema #}

        </main>
    </div> {# Fin Contenido Principal (main + header) #}
</div> {# Fin flex container principal #}

<style>
    /* Estilos para placeholders de gráficos (requiere JS para dibujar) */
    .chart-placeholder {
        /* background-color: #f9fafb; /* bg-gray-50 */
        /* display: flex;
        align-items: center;
        justify-content: center;
        color: #9ca3af; /* text-gray-400 */
        /* font-size: 0.75rem; */
        /* Placeholder visual */
        /* border-top: 1px solid #e5e7eb; */
    }
    .chart-placeholder::before {
       /* content: 'Mini-Gráfico Aquí'; */
    }

    /* Animación Fade-In (simplificada) */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .fade-in-section {
        animation: fadeIn 0.5s ease-out forwards;
    }

     /* Animación Reveal para Tarjetas (simplificada) */
    @keyframes fadeInUp {
        from { opacity: 0; transform: translateY(15px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .card-reveal {
        opacity: 0;
        animation: fadeInUp 0.5s ease-out forwards;
         /* Delays se aplican inline */
    }

    /* Consideración para reducir movimiento */
    @media (prefers-reduced-motion: reduce) {
      .fade-in-section,
      .card-reveal,
      .counter, .counter-currency { /* Desactivar animaciones si afectan */
        animation: none;
      }
       .hover\\:-translate-y-1:hover { /* Desactivar transformaciones hover */
           transform: none;
       }
    }

    /* Estilos para Skeleton Loading (Ejemplo Básico) */
    .skeleton {
        background-color: #e5e7eb; /* gray-200 */
        border-radius: 0.25rem; /* rounded */
        animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: .5; }
    }
    .skeleton-text { height: 1rem; width: 80%; }
    .skeleton-title { height: 1.5rem; width: 60%; margin-bottom: 0.5rem; }
    .skeleton-card { padding: 1.5rem; }

</style>

<script>
document.addEventListener('DOMContentLoaded', function() {

    // --- Animación Contadores ---
    function animateCounter(el, target, isCurrency = false) {
        const duration = 1000; // ms
        const frameDuration = 1000 / 60; // 60 fps
        const totalFrames = Math.round(duration / frameDuration);
        const easeOutQuad = t => t * (2 - t);
        let frame = 0;

        const countTo = parseFloat(target);
        if (isNaN(countTo)) {
            el.textContent = isCurrency ? '$0' : '0'; // Valor por defecto si target no es número
            console.warn("Target no es un número válido para el contador:", target, el);
            return;
        }

        const update = () => {
            frame++;
            const progress = easeOutQuad(frame / totalFrames);
            const currentVal = Math.round(countTo * progress);

            if (isCurrency) {
                // Formato simple de moneda (sin decimales para este ejemplo)
                el.textContent = '$' + currentVal.toLocaleString('es-CO');
            } else {
                el.textContent = currentVal.toLocaleString('es-CO');
            }

            if (frame < totalFrames) {
                requestAnimationFrame(update);
            } else {
                 el.textContent = isCurrency ? '$' + countTo.toLocaleString('es-CO', {maximumFractionDigits: 0}) : countTo.toLocaleString('es-CO');
            }
        };
        requestAnimationFrame(update);
    }

    document.querySelectorAll('.counter').forEach(counter => {
        const target = counter.getAttribute('data-target');
        // Iniciar animación solo si el elemento está visible (optimización básica)
        const observer = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting) {
                animateCounter(counter, target, false);
                observer.unobserve(counter); // Animar solo una vez
            }
        }, { threshold: 0.1 });
        observer.observe(counter);
    });

    document.querySelectorAll('.counter-currency').forEach(counter => {
        const target = counter.getAttribute('data-target');
         const observer = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting) {
                animateCounter(counter, target, true);
                 observer.unobserve(counter);
            }
        }, { threshold: 0.1 });
        observer.observe(counter);
    });

    // --- Control Dropdowns (Header) ---
    function setupDropdown(buttonId, dropdownId) {
        const button = document.getElementById(buttonId);
        const dropdown = document.getElementById(dropdownId);

        if (button && dropdown) {
            button.addEventListener('click', (e) => {
                e.stopPropagation();
                dropdown.classList.toggle('hidden');
            });

            document.addEventListener('click', (e) => {
                if (!dropdown.contains(e.target) && !button.contains(e.target)) {
                    dropdown.classList.add('hidden');
                }
            });
        }
    }
    setupDropdown('notification-button', 'notification-dropdown');
    setupDropdown('user-dropdown-button', 'user-dropdown');

    // --- Control Menú Móvil ---
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    if (mobileMenuButton && mobileMenu) {
         mobileMenuButton.addEventListener('click', () => {
             mobileMenu.classList.toggle('hidden');
         });
    }

    // --- Placeholder para inicialización de Gráficos ---
    // Aquí iría el código para buscar elementos '.chart-placeholder'
    // y usar una librería como Chart.js o ApexCharts para dibujar los gráficos
    // usando los datos obtenidos (probablemente vía AJAX o pasados desde Django)
    // Ejemplo conceptual:
    // document.querySelectorAll('.chart-placeholder').forEach(el => {
    //    const type = el.dataset.chartType;
    //    fetchChartData(type).then(data => {
    //        renderChart(el, type, data);
    //    });
    // });
    console.log("Placeholder: Inicializar gráficos aquí.");


    // --- Placeholder para Funcionalidad AJAX ---
    // Aquí podrías tener funciones para actualizar datos periódicamente
    // o manejar envíos de formularios sin recargar la página.
    // Ejemplo conceptual:
    // function refreshStats() {
    //    fetch('/api/dashboard-stats/')
    //       .then(response => response.json())
    //       .then(data => {
    //           updateStatElement('servicios_hoy', data.servicios_hoy);
    //           updateStatElement('ingresos_hoy', data.ingresos_hoy, true);
    //           // ...etc
    //       });
    // }
    // setInterval(refreshStats, 30000); // Actualizar cada 30 segundos
    console.log("Placeholder: Configurar actualizaciones AJAX/WebSockets aquí.");

}); // Fin DOMContentLoaded
</script>

{% endblock %}